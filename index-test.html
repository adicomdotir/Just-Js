<!doctype html>
<html lang="en">

<head>
    <title>Hattrick Tools</title>
    <style>
        tr,
        td {
            text-align: center;
            border: 1px solid black;
        }

        label {
            text-align: left;
        }

        input {
            text-align: right;
            width: 25%;
        }

        .rect {
            margin: 2px;
        }
    </style>
</head>

<body>
    <table style="height: 200px;">
        <tr>
            <td>
                100
            </td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>100</td>
            <td>
                <div>
                    Team Sprite
                </div>
                <div>
                    <input id="team_spirit" type="number" min="1" max="10" value="5">
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <div>
                    <input id="winger1" type="checkbox" onclick="myFunction(event)">
                </div>
                <div id="section_winger1">
                    <div class="rect">
                        <label>Stamina</label>
                        <input id="stamina_winger1" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>Form</label>
                        <input id="form_winger1" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>PM</label>
                        <input id="pm_winger1" type="number" value="5" disabled="true">
                    </div>
                </div>
            </td>
            <td>
                <div>
                    <input id="mid1" type="checkbox" onclick="myFunction(event)">
                </div>
                <div id="section_mid1">
                    <div class="rect">
                        <label>Stamina</label>
                        <input id="stamina_mid1" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>Form</label>
                        <input id="form_mid1" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>PM</label>
                        <input id="pm_mid1" type="number" value="5" disabled="true">
                    </div>
                </div>
            </td>
            <td>
                <div>
                    <input id="mid2" type="checkbox" onclick="myFunction(event)">
                </div>
                <div id="section_mid2">
                    <div class="rect">
                        <label>Stamina</label>
                        <input id="stamina_mid2" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>Form</label>
                        <input id="form_mid2" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>PM</label>
                        <input id="pm_mid2" type="number" value="5" disabled="true">
                    </div>
                </div>
            </td>
            <td>
                <div>
                    <input id="mid3" type="checkbox" onclick="myFunction(event)">
                </div>
                <div id="section_mid3">
                    <div class="rect">
                        <label>Stamina</label>
                        <input id="stamina_mid3" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>Form</label>
                        <input id="form_mid3" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>PM</label>
                        <input id="pm_mid3" type="number" value="5" disabled="true">
                    </div>
                </div>
            </td>
            <td>
                <div>
                    <input id="winger2" type="checkbox" onclick="myFunction(event)">
                </div>
                <div id="section_winger2">
                    <div class="rect">
                        <label>Stamina</label>
                        <input id="stamina_winger2" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>Form</label>
                        <input id="form_winger2" type="number" value="5" disabled="true">
                    </div>
                    <div class="rect">
                        <label>PM</label>
                        <input id="pm_winger2" type="number" value="5" disabled="true">
                    </div>
                </div>
            </td>
            <td>
                <div id="final">Midfield RAte: 0</div>
            </td>
        </tr>
    </table>
    <div>
        <button onclick="calculate()">Calculate</button>
    </div>
    <script>
        function calculate() {
            let imCount = 0;
            let final_pm1 = 0;
            let final_pm2 = 0;
            let final_pm3 = 0;
            let final_winger1 = 0;
            let final_winger2 = 0;

            if (document.getElementById('mid1').checked) {
                imCount++;
                const stamina_mid1 = Math.pow((Number(getValueFromId('stamina_mid1')) + 6.5) / 14, 0.6);
                const form_mid1 = Math.pow((Number(getValueFromId('form_mid1')) - 0.5) / 7, 0.45);
                const pm_mid1 = Number(getValueFromId('pm_mid1'));
                final_pm1 = stamina_mid1 * form_mid1 * pm_mid1;
            }
            if (document.getElementById('mid2').checked) {
                imCount++;
                const stamina_mid2 = Math.pow((Number(getValueFromId('stamina_mid2')) + 6.5) / 14, 0.6);
                const form_mid2 = Math.pow((Number(getValueFromId('form_mid2')) - 0.5) / 7, 0.45);
                const pm_mid2 = Number(getValueFromId('pm_mid2'));
                final_pm2 = stamina_mid2 * form_mid2 * pm_mid2;
            }
            if (document.getElementById('mid3').checked) {
                imCount++;
                const stamina_mid3 = Math.pow((Number(getValueFromId('stamina_mid3')) + 6.5) / 14, 0.6);
                const form_mid3 = Math.pow((Number(getValueFromId('form_mid3')) - 0.5) / 7, 0.45);
                const pm_mid3 = Number(getValueFromId('pm_mid3'));
                final_pm3 = stamina_mid3 * form_mid3 * pm_mid3;
            }
            if (document.getElementById('winger1').checked) {
                const stamina_winger1 = Math.pow((Number(getValueFromId('stamina_winger1')) + 6.5) / 14, 0.6);
                const form_winger1 = Math.pow((Number(getValueFromId('form_winger1')) - 0.5) / 7, 0.45);
                const pm_winger1 = Number(getValueFromId('pm_winger1'));
                final_winger1 = stamina_winger1 * form_winger1 * pm_winger1;
            }
            if (document.getElementById('winger2').checked) {
                const stamina_winger2 = Math.pow((Number(getValueFromId('stamina_winger2')) + 6.5) / 14, 0.6);
                const form_winger2 = Math.pow((Number(getValueFromId('form_winger2')) - 0.5) / 7, 0.45);
                const pm_winger2 = Number(getValueFromId('pm_winger2'));
                final_winger2 = stamina_winger2 * form_winger2 * pm_winger2;
            }
            const MAX_PLAYER = [0, 1, 0.935, 0.825];
            const imRating = (final_pm1 + final_pm2 + final_pm3) * MAX_PLAYER[imCount];
            const wingerRating = (final_winger1 + final_winger2) * 0.45;
            const ratingWithTeamSpirit = (imRating + wingerRating) * getTeamSpirit();
            const ratingRound = Math.round(ratingWithTeamSpirit / 2 * 1.15) + 3;
            const finalRating = ratingRound / 4;
            document.getElementById('final').innerHTML = 'Midfield RATE: ' + finalRating;
        }

        function myFunction(event) {
            const id = 'section_' + event.target.id;
            if (!event.target.checked) {
                let nodes = document.getElementById(id).getElementsByTagName('*');
                for (let i = 0; i < nodes.length; i++) {
                    nodes[i].disabled = true;
                }
            } else {
                let nodes = document.getElementById(id).getElementsByTagName('*');
                for (let i = 0; i < nodes.length; i++) {
                    nodes[i].disabled = false;
                }
            }
        }

        function getValueFromId(id) {
            return document.getElementById(id).value;
        }

        function getTeamSpirit() {
            const teamSpirits = [
                0.72,
                0.86,
                0.93,
                1.00,
                1.07,
                1.14,
                1.21,
                1.28,
                1.35,
                1.42
            ];
            return teamSpirits[Number(getValueFromId('team_spirit')) - 1];
        }
    </script>
</body>

</html>